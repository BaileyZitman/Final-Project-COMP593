# History

This file contains a detailed summary about each session I worked on the project. Each and everytime work was completed on this project the changes and activities was logged to this file in order to keep an accurate activity summary. Each entry (number in the list) represents a different session. For each session the date is provided, the amount of time logged for that session is provided and a description of the activities completed/worked on is provided. 

**Note:** Date is presented in the format YYYY-MM-DD
**Note:** Time Logged is measured to the quarter hour and expressed in hours

1. **Date:** 2021- 03 - 17 **Time Logged:** 2 **Description:** The assignment was assigned today and to get prepared I started by creating a new repository called "Final- Project-COMP593". I also downloaded Github Broswer and configured Github to be paired with VSCode (my default editor) using a token to enable working on the repo from my host computer. This alows me to push, pull, and merge (etc...) changes made on my local machine to the repository. I also created this History file which will serve as a working log throughout the project. It uses markdown formatting and i first attempted to create a table but the formatting was not accomplishing the desired outcome. This was identified in my first test commit (to see if i could merge and if the formatting was desirable) and as such I have update the formatting of the "History.md" to not be formatted into a table but a list. The important headers are shown in **bold** text. Made a second commit to test the second attempt at formating. The formatting is acceptable. made a few modifications regarding the README.md file but it still needs to be updated down the line with functionality, constraits, and any info the user could use to better utlize the script. Took a break but didnt commit changes at this time. See next session.
   
2. **Date:** 2021- 03 - 17 **Time Logged:** 2 **Description:** Started again a few hours later. Started building the python script by producing a ***header*** and testing the connection. Thankfully my Mars Rover Script came in handy (not the test tho :/ ) and the connection was easy (already had a dev key and base, base code to work off of). I tested manipulating the data and got it to print the data i wanted to the command prompt. started the part of the script that builds the database. RIGHT NOW (may change) the database if called PBMZ-db-FP.db. Attempted to create a table and got an syntax error and sqlite execution error (caused by same thing presumably). I was correct. Firgured it out by mistake when reformatting the primary key which turns out needed to be reformatted anyways. A table has now been created in the database mentioned above called "Astronomy Image of The Day" (this will be the only table in the database). Played around with adding data to the table. had issues with unsupported type. put down for the night. I committed my changed to the ***Testing*** branch. Note: If looking through history (Github history) the python file is only in a test phase and not complete. It includes lots of testing ***errors*** (not actual errors). 

3. **Date:** 2021- 03 - 18 **Time Logged:** 1.5 **Description:** Worked away at trying to upload data from the obtained image (json object) to the table "Astronomy Image of The Day" in the database that the script also creates. The issue i was having with the unsupported type was with datetime. For some reason both integer type "datetime" and "numeric" (in the "create_AIOD_Table =" variable) didnt work and came back with that error. Wrapped the time variable (may be temporary) with ***str()*** and that did the trick. The time is outputted using the 24hr clock right down to the second currently. The python script now creates a directory called "./Saved Images" which will be used to save images to each day. This will serve as a history of previously used backgrounds. The script now has the ability to retrieve the image obtained from the internet through the requests module. I did this in my side-project over the break and already knew how so I didnt get any errors. The obtained image is saved as a ***.jpg*** or a ***.png*** depending on the url that is obtained to the directory mentioned above and created through the script. As of right now the Hash value and file size still needs to be calculated.Committed the changes to the testing branch

4. **Date:** 2021- 04-07 **Time Logged:** .25 **Description:** Tested python script and was getting a key error and noticed that copyright is not available. Removed that option from the script. Tested again and works. Did not commit changes at this time.
   
5.  **Date:** 2021- 04-11 **Time Logged:** 7 **Description:** Retested my python script and realized it is not just the copyright key that is missing in some cases all of keys will be different (in json object) depending on the day of the image.Looked up why that is and on the ["API webpage"](https://api.nasa.gov/) it mentions that the the copyright parameter is only returned when the image is not part of public domain. Redesigned my database to only save the hash, file name, file size, NON HD url, and date-time of download In the case of a video, we use the last available image instead. create a function called Connection_and_json() in the python file and that is used to make the connection and get the returned json object. I didnt run into very many issues do this because I already completed this code previously and just put it in a function for cleaner scipting and reusability. I also created a function called parse_json() that will parse the json object to determine what keys are used for that day because as mentioned aboved, they keys in the json object will be different depending on the situation. There are certian ones that will always be returned though. The function may be deleted depending on if i can make the database variable. will work on that later. Reworked my code and moved things around by modifying how the python file exectute things and in what order. Added an if statement instead to filter on json["media_type"] to establish whether the returned object is an image or video. Only append information to the database and obtain the image of the day if an image is returned. I created two additional functions, get_hash and get-size that will get the hash and size of the file corresponding the the object in question. I did google how to complete these steps and found this [webpage](https://www.journaldev.com/32067/how-to-get-file-size-in-python) extremely helpful in getting the size of the file. To get the hash value, i reference two webpages [Nitratine](https://nitratine.net/blog/post/how-to-hash-files-in-python/) and [Programiz](https://www.programiz.com/python-programming/examples/hash-file). Next i started working on the PowerShell script and it is called "FinalProject.ps1". I started by creating the header and then a function called "locate_file_w_hash" that will obtain the HASH value for every image in the directory "./Saved Images". This function will also complete the comparison but will create another function called "compare_hash" embedded within to make it easier. The "compare_hash" function first creates a variable with the current date and then i used this [website](https://mrpanas.com/powershell-and-sqlite/) to figure out how to query a database. I can query the database now through powershell but having an issue with filtering on the name by a specfic value. I want to be able to get the hash returned from the DB for the current date only. Finally got it to work, my query turned out to be okay but i needed to switch the ' and " around for it to successfully complete. Some how i am not able to use backspace anymore in this file...oddd...i will deal wilth it for now. I have created another function that will compare the two hashes together and will be emmbedded into the locate_file_w_hash function. I also changed the name of the function "compare_hash" to "Connection_and_query" because that is what it does and created a new function called "compare_hashes". I can sucessfully obtain the hashes however having a hell of a time getting the hash to compare sucessfully. After some trial and error finally was able to figure out how to compare my two hash values. Now i know if the image is already downloaded. I completed this by doing alot of googling and found these websites helpful: ["Microsoft Docs"](https://docs.microsoft.com/en-us/documentation/), our trusty friend ["Regex 101"](https://regex101.com/), good old powershell tests. For example, what actually solved the issue was using the cmdlets Get-Member and Get-ItemProperty within powershell after the script was done to obtain key information about the objects I was working with. In my script i need the hashes to be in the exact same format to compare the two hashes against one another and as a result i had to covert from an object to a string back to an object. When the conversion from string to object was completed the object properties became misaligned (compared to before) and I was actually working on $hash but and was outputting $hash as opposed to $hash.p4. When it converted it to an object the value i wanted was assigned the property p4 and i was comparing the entire variable opposed to just $hash.p4. I also spent way to long trying many different methods to modify the returned value for $hash to be comparible to $connection_results. I tried string concatonation (example: i had an addition line that was trying to append a ; at one point $hash2 = $hash + ";" and $hash2 = "$hash;" ) but that didnt work. Then i tried trimming the ";" off the $connection_results and that didnt wanna work either. FInally I tried the -Replace method and that worked. I browse numerous pages on the Microsoft Docs webpage including: ["Everything you need to know about $null"](https://docs.microsoft.com/en-us/powershell/scripting/learn/deep-dives/everything-about-null?view=powershell-7.1), ["About Comparison Operators"](https://docs.microsoft.com/en-us/powershell/module/microsoft.powershell.core/about/about_comparison_operators?view=powershell-7.1), and [String.Trim](https://docs.microsoft.com/en-us/dotnet/api/system.string.trim?view=net-5.0). I Then modified my directory to saved the date of the image and the date it was obtained. This meant also modifying the Image file to that of the date of the image and not the date it was obtained. No issues here becuase it pretty straight forward. I realized when rerunning my python script to fill the database to test my powershell script on the foreach loop i created earlier, i need to put the comparison in a function as well and then i can compare each hash and not just the last file in the directory based on name. so i created a new function called "compare_hashes". Broke my script while trying to loop and am done for the night. committed changes to Github Testing branch becuase well it dont work.also i gotta deal with this error "command 'markdown.extension.onEnterKey' not found". Hoping it fix's itself before I go crazy.    
   
6.  **Date:** 2021- 04-13 **Time Logged:** 1 **Description:** HEY BACKSPACE WORKS AGAIN!!! see i knew reloading would solve the trick. Okay so this was a pretty short session. I wanted to get my Foreach-object in "./Saved Images/" to work properly. SO i started by creating a ***test*** file called "testing.ps1" (may or may not be uploaded to testing branch of repo). It turns out my first issue was with the function called Connection_and_query becasue the other day when i was testing, the image of the day was a video and my script skips videos and need to assign a random date like $date = "2021-01-02". As planned this will produce the date of the day running the script to feed  into the query request. There was a error with the query when i removed the pre-assigned date and had $date =  $date = Get-Date -Format "yyyy/MM/dd" | Out-String. This worked before with a predetermined date and skipping this line but now it adds the '"' on a new line and not after in the query request. removed Out-String and now while we cannot modify it (turns out we dont have to replace / with -), the '"' is now directly after the date and query request is goucci. Originally with the function locate_file_w_hash was a Foreach-object loop and it contained a while loop but that wont work. But i was looking at the ["Microsoft Docs"](https://docs.microsoft.com/en-us/powershell/module/microsoft.powershell.core/foreach-object?view=powershell-7.1) webpage for the ***ForEach-Object*** cmdlet and it isntly looping through the directory and isnt going to be able to accomplish our objective. I then started looking at other Mircosoft Docs including: ["Get-Location"](https://docs.microsoft.com/en-us/powershell/module/microsoft.powershell.management/get-location?view=powershell-7.1), [Get-Item](https://docs.microsoft.com/en-us/powershell/module/microsoft.powershell.management/get-item?view=powershell-7.1), [Get-ChildItem](https://docs.microsoft.com/en-us/powershell/module/microsoft.powershell.management/get-childitem?view=powershell-7.1) and [Get-ItemProperty](https://docs.microsoft.com/en-us/powershell/module/microsoft.powershell.management/get-itemproperty?view=powershell-7.1). I also looked at the website [buisness.com](https://www.business.com/articles/powershell-for-loop/) and found a webpage that explains the ***for*** loop, ***ForEach-Object*** loop and the ***while*** loops in powershell. I decided to use a for loop instead on a variable. I set up the script to create a variable called "images" which contain all of the images that this script would have saved in the past. it will save all of the files in that directory to the variable and then proceed to create an empty array called "Status". For each file in the images variable, the powershell script will get the hash, modify it to be the exact same as the database hash comparing to, and then complete the comparison. For each image compared, it will add to the array ***status*** and then return teh entire array back to the main body. This will later be used, by searching through the array for an "=" to determine if the hash as already been downloaded by THIS script. All of this is still in the testing.ps1 file and will need to be moved over to FinalProject.ps1 for the final integration. But wanted to test and build in a serpate file. Changes not committed at this time. 
   
7.  **Date:** 2021- 04-14 **Time Logged:** 1.5  **Description:** Started by using test.ps1 and copied over the changes made to the file FinalProject.ps1. I simply deleted the function **locate_file_w_hash** from the file "FinalProject.ps1" and replaced it with the newly, modified function of the same name from "testing.ps1". Also modifed the function **Connection_and_query** in the final powershell script to reflect the changes i made in the testing file as well (removed out-string and such as mentioned in yesterdays history). The script is working as intented but am getting way to much outputted info- this is only temporary for testing and sanity checking purposes. To determine how to find the "=" inside the array, i did a similar things as i have done in the past throughout this script and went to powershell and typed in $status | Get-Member, which becasue the variable is still loaded, obtain the available methods for this variable (also used $status.GetType() to determine it is an array). Couldnt find a "find" method and cannot convert to a string with $status.ToString(). Looked on google how to search through an array in powershell and found this [webpage](https://social.technet.microsoft.com/Forums/ie/en-US/83c72054-829f-4080-b8cf-060c7ea0ad68/powershell-how-to-search-for-a-string-in-an-array-of-objects?forum=ITCG) which explains how we can use ***-match*** and effectivly regex to match a specific string in the array. in this case we want to know if one already exists so we will search through the array for a "=". if found use that image if not get the new image through the python script and use that. Using that webpage it was incredibly easy to make an if/else statement to filter the array and search it. depending on the results either execute the python script or just use the image found.I decided to modify the $status array and turn it into a hash. The key will be the file name and the value will be the result of the comparison, an easy way to print the file that matches. looked up the Microsoft Docs webpage ["About Hash Tables"](https://docs.microsoft.com/en-us/powershell/module/microsoft.powershell.core/about/about_hash_tables?view=powershell-7.1) and the webpage ["About Comaprison Operators"](https://docs.microsoft.com/en-us/powershell/module/microsoft.powershell.core/about/about_comparison_operators?view=powershell-7.1) to help make it easier. Used the info i found to modify the array into a hash and tested it in my test file before moving over to the finalproject.ps1 file. Also it broke when i did, so i changed my if/else to not filter on a regex (-match) and modified it to used $Status.ContainsValue("=") instead and that works. i used this [website](https://powershellexplained.com/2016-11-06-powershell-hashtable-everything-you-wanted-to-know-about/#checking-for-keys-and-values) to know how to complete this and it is just searching the values for the "=" sign opposed to regexing an array. The hash is nice but having an issue with fulling the file path for the hash value "=" also, as you can tell up to this point it only looks in ./Saved Images because that is were MY script saves them. However, incase another student already downloaded the image, i wont to be able to have the hash come back equal in that instance to. Need to modify my script to allow the user to specify which directories to search. Will put down till later today. Did not commit changes at this time but will after next session. See next session.
   
8.  **Date:** 2021- 04-15 **Time Logged:** 8 **Description:** I started by modifying the FinalProject.ps1 script again. I added an if statement to determine if the connection was sucessful. if not then there is no entry for the current day or the database doesn exist. This means that the function ***compare_hashes*** does not need to return anything if there is no entry because it wont run if there isnt any. removed returning of "!!!" and the corresponding elseif case in the if/else statement taht searches for the "=". All of this was completed before the last class and i realized how verbose my FinalProject.ps1 script is. I started playing around with comparing the hash using powerhsell pipelines. Came accross this combination very quickly (trail and error in powershell) "Get-ChildItem ".\Saved Images" | Get-FileHash | Where-object -Property Hash -e -Value $hash". This returns the hash and path of a file that matches the $hash, which will contain the hash of the database. This is way eaasier and will play  around with condensing my script in testing.ps1 before i continue. I deleted the contents of testing.ps1 and started my script again copy over the necessary pieces, to see if i can condense the FinalProject.ps1 file. Committed the changes made so far from the last commit to see the difference between this commit and future ones. I rewrote both testing.ps1 and subsequently FinalProject.ps1 to be WAYYYY more refined thanks to the last lecture. I knew this beforehand im just dumb and made it difficult for myself. i removed the functions ***compare_hashes*** and ***locate_file_w_hash*** and replaced that the powershell pipeline mentioned above. This was assigned the a variable named "find_hash" which is used to filter if the hash was found or not. if the variable is full do one thing if not do another...Now need a way to enter via command line parameters which directorys to search for images so the whole file system is not chosen. This will be on top of the ./Saved Files directory. I used ["this website"](https://ss64.com/ps/syntax-args.html) to help me acomplish the objective. I can sucessfully get a path to be provided to the script but im having it add to the variable arleady containing the search from "./Saved Images". I want this script the scan ./Saved Images in addition to a simplied directory. Default can be used to only use the directory ./Saved Images. Its giving me an error on "+=" because its not a supported method but if i change it to a string using "| Out-String" i can. Now need to change back. Using ["this webpage"](https://docs.microsoft.com/en-us/powershell/module/microsoft.powershell.utility/convertfrom-string?view=powershell-5.1) and a little bit of your lecture notes for week 13, I did "find_hash = $find_hash| ConvertFrom-String" but then realized the outputted properties (what i am after) would be variable. I solved this by creating a second variable that will contain the files found with the hash in question for the SECOND directory. by default this will be ./Saved Images but will be the directory the user specifies to search as well. This results in a duplicate file being entered back to the terminal, in the case the second directory has the same file path as the first, only output the first path. I copied over the testing.ps1 after the changes to FinalProject.ps1. Now its time to get the powershell to initate the python script. I originally had the ./Saved Images created in the python file but that doesnt make any sense anymore because i am looking through it before it runs. added the equivalent to powershell with the help of Test-Path. I looked up the [documentation](https://docs.microsoft.com/en-us/powershell/module/microsoft.powershell.management/test-path?view=powershell-7.1) to make it easier. added an if statement on the result of testpath, if true continue, if false create the path before continuing. Used the Microsoft [New-Item](https://docs.microsoft.com/en-us/powershell/module/microsoft.powershell.management/new-item?view=powershell-7.1) webpage to help create a new path of ./Saved Images if it does exist. removed that portortion from the script FinalProject.py and copied over it from testing.ps1 to FinalProject.ps1. Now will look at the python script FinalProject.py to see what can be modified based on the powershell script capabilities. Removed line 80 "if not os.path.isfile("./Saved Images/" + name_of_file):" that checks to make sure the image is not already downloaded. This is redundent becasue we know it isnt at this point. Don't need to remove anything but need to return the file-path and that is not determined as of yet in the script. added return of the new created File_Path variable to the bottom of FinalProject.py which will hopefully return the file path created by the script. Added an if statement to confirm if the database exists or not yet, if it does run the query, if not no database error and run python script. got the file path to output from the python script and to the terminal at the same time, however nothing else is outputted. Also need a way to redownload the image without adding a new entry. With the idea coming from ["This webpage"](https://stackoverflow.com/questions/53919693/passing-a-variable-from-powershell-to-python), I decided to use command line parameters to pass information to my python script. Specifically a 1 if a new entry and download is to occur and 2 if just the download is to occur . Now the python script main body is contained in an if statement on argv 1 and the else statement will be a sql query for the file path of the date in question. I used the lab regarding databases in python for assistance and had no issue with the query request formulation. I ran into an issue when the diretcory exists and there is an entry but not a loacted file, it would output a weird returned file location from the python script. modified the line $File_Path = $(python .\FinalProject.py "2") to "$File_Path = $(python .\FinalProject.py "2") | ConvertFrom-String -Delimiter "'". this will change the next line to $File_path.p2 but it works. now the image location and path is available in all instances. Still need to "use last available image" if a video is available instead of an image. doing that now. will try to get the previous days image instead and used ["this website"](https://datatofish.com/get-previous-current-and-next-day-system-dates-in-python/) to figure out how to get the previous day with a datetime object. I didnt end up using that. what i did instead was do a new query and assign all of the filepaths and dates into a variable. the i used something like this ***File_Path[0][0]*** to retreive the path of latest file and use that. Currently the python script produces a part of a filepath. used the powershell pipeline $File_location = Get-ItemProperty FullName -Path $path with $File_Location.FullName to get the full path. Relealized when the python script is run with a "2" it doesnt actually redownload the image. set that up using code from elsewhere in the scripts. Now will create a function called "change_background" to change the background. I used a ["reddit thread"](https://www.reddit.com/r/PowerShell/comments/5ske2m/setwallpaper/) which provides the function we need. just need to modify. Can now successfully change the background image, without a reboot but it doesnt work EVERY time. Still need to do more testing to see if the script works in every instance. but I am done for the night. Committed my changes to the testing branch of the repository.
   
9.  **Date:** 2021- 04-16 **Time Logged:** 2.5  **Description:** Started by using testing.ps1 and modifying the finalproject.ps1 script. I modified it but putting the duplicated code into a function called FilePath_to_background and this now runs the background change function. The backgorund change function was also modifed to be inside of a loop because when we try to set RUNDLL32.EXE USER32.DL to true, sometimes it reverts without actually changing anything. Copied over the testing.ps1 to FinalProject.ps1. Realized need to output text from python script and I came up with an easy solution. this script will save the output to a variable which will be saved to a temporary file. the powershell script will read the temp file and print/seperate the info we want. The powershell script captures the filepath from the pythons script still but the output of the python file  is saved to ./temp.txt. Modified the powershell script to test to see if it exists and if it does read from it. Sucessfully reads the temp.txt file the python script will create if necessary and then delete it. Get an error if the database is not already created. db_cursor.execute('SELECT "File Path", "Date Image was Obtained" FROM "Astronomy Image of The Day"'). sqlite3.OperationalError: no such table: Astronomy Image of The Day. This is becasue today, no image is available and a video is available instead. In this case the request will fail becuase there is no previous image to use. If this is the case, present an error message, stating as such and dont use any image, indicate that will have to wait till tmrw. This script will be submitted with a database for this reason but include a catchcase regardless.Instead of not using an image there is a default image that was chosen through extensive tests that will be used instead. The script will come with a default image that will be used instead. Added more text to be  outputted from the python script when things get done. the script seems to function as intended. Redid the columns in the database, to include the "explanation" again,  and copyright but this time compyright isnt mandatory (didnt include NOT NULL like the others). used the previous function parse_keys here to parse the returned json object for what keys are returned, and if copyight is returned add it. Need to look into a way to make this script run everyday if the user chooses. Taking a break for now. did not commit changes at this time. Just eating, see next session
    
10.  **Date:** 2021- 04-17 **Time Logged:** 4 **Description:** As you can see from the date, i did not resume after food and started again the mext morning. Not without nothing though, while i needed a break I still wanted to see if i can get some more information about scheduling a task to run everyday through powershell itself. I found the webpage ["New-ScheduledTask"](https://docs.microsoft.com/en-us/powershell/module/scheduledtasks/new-scheduledtask?view=windowsserver2019-ps) and ["New-ScheduledTaskTrigger"](https://docs.microsoft.com/en-us/powershell/module/scheduledtasks/new-scheduledtasktrigger?view=windowsserver2019-ps) while browsing solutions, becasue i did think of just using "sleep 86400" but that seems cheap. This will schedule a task through the task manager from the script. Before I do anything, will commit changes from yesterday. After committed changes tested script and everything worked but didnt change the background image even though the registry value was changed. I got it to chnage by setting the loop at 35 and not 20. Am think of how I want to set this script up to have it run daily, but with additional options to set weekly, yearly, and etc. For this I have decided to create a new script called "RunAPODPBMZ.ps1" and this will be the script that actually runs both of these two other scripts. It will not have command line parameters but input, then it will trigger the FinalProject.ps1 script defending on the users configuration. I created this new file and added a header, and basic text to be outputted to the user (color coded!!) and now need a way to prompt input. I know about Read-Host and used these ["this website"](https://www.itprotoday.com/powershell/prompting-user-input-powershell) and the Microsoft Docs [Read-Host](https://docs.microsoft.com/en-us/powershell/module/microsoft.powershell.utility/read-host?view=powershell-7.1) webpage to my advantage. I can just do: $additional_directory = Read-Host "Enter the additional directory to search". This is repeated for three configuration settings, directory to search, the occurance of the scirpt and the time in which it is supposed to run. I put each Read-Host in a while loop to loop until a valid entry is provided, on top of that it uses regex or comparison to determine if a valid entry was supplied by the user. I couldnt get regex to work for some reason on the occurence option and used comparison instead. It searches the array holding the correct values and if it is found within (case sensitive on purpose) then continue. Now that I have the information I want from the user coded, need to actually execute FinalProject.ps1, based on the selected options. To do this i created a function called Create_Task that will create the task. While reveiwing the microsoft webpages mention at the start of this session, I realized the task executes in a default directory and as such we need to get the user to specify the diretory containing FinalProject.ps1. We can program this in automatically and search for the diretory but to save time (in script not makiing script) Will prompt the user for the directory insead. actually I dont even need to do that. This script already reuqires you to be in the current working directory to begin with. can just get the current working directory-programing it is easier. I can do this comamnd $Path = pwd which is an alias to get the working directory and use that as the path of the task. I used a line like "$trigger = New-ScheduledTaskTrigger -$Occurrence -At $Time" and got an error because it cannot covert $occurance to a automation object, in that case will need an if/elif/else clasue to set the long way. The task now schedules itself but need to figure out what i need to execute exactly for it to work properly. I think i fixed the issue, will see in 4mins when the task runs, by getting PowerSheel.exe to start with the arguements ". ./FinalProject.ps1 $Directory". This will call the script with that name and parameter. I Do not think it works, the database and image should of been retreived. Need to try a different approach. I am going to trying building a task mainually and getting that to work first. Okay I got it to run My script by creating the task manually, of Note: need to execute powershell at its location in the directory, then need to indicate the starting directory (cwd of RunAPODPBMZ.ps1) and then run the FinalProject.ps1 script from there. Now to code that. Shouldnt be an isse becasuse I already have most of it. Yeah i have no idea whats happening but it isnt running my scheduled task for some reason. putting down for now. Scratch that i figured it out!!!! I needed to modify the settings on task manager itself, becuase the only issue is im on a battery, on a laptop and there is a setting that needs to be updated. Thanks to ["This website"](https://docs.microsoft.com/en-us/powershell/module/scheduledtasks/new-scheduledtasksettingsset?view=windowsserver2019-ps), I included $settings = New-ScheduledTaskSettingsSet -AllowStartIfOnBatteries. This fixed the issue. Also now that the task, scheduler works, need to configure what happens if now is chosen. I know about the Start-Process cmdlet that maybe useful here. Looked at the corresponding [webpage](https://docs.microsoft.com/en-us/powershell/module/microsoft.powershell.management/start-process?view=powershell-7.1) and it appears I can use it to my advantage. Using the webpage as assistance, got the powershell script to call the other one immediatly and process in that window. It waits till the process is done before closing However it still closes to quickly to read the output. Added the line Read-Host -Prompt "Enter Any Key to Exit"  at the end of the FinalProject.ps1 File and now the second window will not close until the user enters the prompt. Now That i got that tested and confirmed it works, both scheduling and now. Am done for the day. Spent alot of time on this recently and am getting close but not quite there yet. Gotta do more testing and refinement and make the readme file. It is currently showing incorrect information now. Committed changes. 

11.  **Date:** 2021- 04-17 **Time Logged:** 3 **Description:** COuldnt resist and got back to work. The first thing i did was comment out the code that search for the ./Saved images directory becasue the directory is needed it will come with the scripts and doesnt need to be checked. I started applying some more comments to my code so i can come back later and understand wants going on with ease. Came accross the "New-ScheduledTaskSettingsSet" and wanted to see if there is other settings that could be applied. Checked out the [Website](https://docs.microsoft.com/en-us/powershell/module/scheduledtasks/new-scheduledtasksettingsset?view=windowsserver2019-ps) again to see if there was anything else i could apply that would work in different situatuons. Just in case, I added "-DontStopIfGoingOnBatteries", becasue once again I am on a laptop and While I'm sure your're not (if your even reading this lol), its an added feature that is handy. another handy one is "-ExecutionTimeLimit" because it opens a new powerhsell session to run FinalProject.ps1, either through a task being executed or by the RunAPODPBMZ.ps1 script, and it waits for user input, this could be handy to kill after a specified time. This takes a "time-span" object which is cool because i get to expiereince them now ;/. I used the microsoft docs website [page](https://docs.microsoft.com/en-us/powershell/module/microsoft.powershell.utility/new-timespan?view=powershell-7.1) to figure out how to use the cmdlet New-TimeSpan. Created a time span and assigned it to be the maxmimum time the script will lay idle. This way if you are doing something, you dont have to deal with it. It will excuse itself. Tested and confirmed closes at 5mins. Realized The file path to powershell may not be the same on mine as it is yours, tried "powershell.exe" instead. changed pwd to Get-Location because it was bitching i was using an alias, which is fair but still man. The script seems to like powerhell.exe and kept that, that should work on your machine as well. Kept commenting my code. Finished commenting all three scripts and I was pretty thorough. Nevermined scracth that the window doesnt close becasue of the prompt. I had an idea and thought about turning the RunAPODPBMZ.ps1,which is the driving script into an .exe file for easy execution. I found a cool utility made my microsoft [ps2exe](https://redmondmag.com/articles/2017/01/27/convert-a-powershell-script-into-an-exe-file.aspx#:~:text=As%20you%20can%20see%2C%20converting,file%20is%20a%20simple%20process.&text=Instead%2C%20you%20will%20need%20to,from%20the%20Windows%20Run%20prompt.)([download](https://www.powershellgallery.com/packages/ps2exe/1.0.5)). This is a wrapper than will run the powershell script by just executing the file. This will be usedul and wont be included in the script but the final submittion will include an executable file, and the scripts so you can execute them individually or as a whole. Removed the whole time limit thing for now becuase of the prompt it wont close. I created a test exe file on what I have so far and it works. Going to wrap up for the night. pretty much done, but was going to add a few more things maybe. Committed changes. 